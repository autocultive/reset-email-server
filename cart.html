<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Cart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Orbitron:wght@600&family=Teko:wght@600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #000;
      color: white;
    }
    h1, h2 {
      font-family: 'Orbitron', sans-serif;
    }
    .hero-banner {
      background-image: url('images/banner/performance-car.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      height: 300px;
      position: relative;
    }
    .hero-overlay {
      background-color: rgba(0, 0, 0, 0.6);
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 1;
    }
    .hero-content {
      position: relative;
      z-index: 2;
    }
    #user-dropdown {
      opacity: 0;
      visibility: hidden;
    }
    #user-dropdown.visible {
      opacity: 1;
      visibility: visible;
    }
    #user-avatar {
      animation: glowPulse 2s infinite;
    }
    @keyframes glowPulse {
      0% {
        box-shadow: 0 0 0 0 rgba(250, 204, 21, 0.5);
      }
      70% {
        box-shadow: 0 0 0 12px rgba(250, 204, 21, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(250, 204, 21, 0);
      }
    }
  </style>
</head>
<body class="antialiased">

  <!-- üåê Navigation Bar -->
  <header class="bg-black border-b border-gray-800 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
      <a href="index.html" class="flex items-center px-10 py-1 md:px-12 md:py-2">
        <span class="text-xl md:text-2xl font-extrabold text-yellow-400 uppercase tracking-[0.25em] relative top-[2px] animate-pulse drop-shadow-[0_0_5px_#facc15]" style="font-family: 'Teko', sans-serif;">AUTOCULTIVE</span>
      </a>
      <div class="w-full md:w-1/2 relative">
        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-yellow-300 text-lg">üîç</span>
        <input type="text" placeholder="Search car accessories..." class="w-full pl-10 pr-4 py-2 border rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-yellow-500 text-sm bg-black text-yellow-400 placeholder-gray-500 border-gray-600" disabled />
      </div>
      <nav class="flex items-center gap-4 text-sm whitespace-nowrap">
        <a href="index.html" class="text-yellow-400 hover:text-yellow-300">üè† Home</a>
        <a href="wishlist.html" class="text-yellow-400 hover:text-yellow-300">‚ù§Ô∏è Wishlist</a>
        <a href="cart.html" class="text-yellow-400 hover:text-yellow-300">üõí Cart</a>
        <a href="login.html" class="text-yellow-400 hover:text-yellow-300">üîê Login</a>
      </nav>
    </div>
  </header>

  <!-- üõçÔ∏è Page Title + Back -->
  <div class="max-w-6xl mx-auto px-4 py-5 flex justify-between items-center">
    <h1 class="text-3xl font-bold text-yellow-400 tracking-tight">üõí Your Cart</h1>
    <a href="index.html" class="text-yellow-300 hover:underline text-base">‚Üê Back to Shop</a>
  </div>

  <!-- üöó HERO BANNER -->
  <section class="hero-banner flex items-center justify-center text-center text-white">
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <h2 class="text-4xl md:text-5xl font-extrabold text-yellow-400" data-aos="zoom-in">Built for Speed ‚Äì Track Every Pick</h2>
    </div>
  </section>

  <!-- üßæ CART ITEMS -->
  <div class="max-w-6xl mx-auto px-4 py-12 relative z-10 bg-gray-900 bg-opacity-80 rounded-xl shadow-xl mt-10" data-aos="fade-up">
    <div id="cart-items" class="space-y-6"></div>

    <!-- üßÆ Invoice + Action Buttons -->
    <div id="cart-footer" class="mt-12 hidden flex-col space-y-6">
      <div class="text-right text-sm text-gray-400">
        <p>Subtotal: <span id="subtotal" class="text-white font-semibold"></span></p>
        <p>Shipping: <span class="text-green-400">Free</span></p>
        <p class="text-lg text-yellow-400 font-bold mt-1">Total: <span id="final-total"></span></p>
      </div>
      <div class="flex justify-between items-center">
        <button onclick="clearCart()" class="px-6 py-3 bg-red-600 text-white text-sm font-semibold rounded-lg hover:bg-red-700 transition">üóëÔ∏è Clear Cart</button>
        <button class="bg-yellow-400 text-black font-bold px-6 py-3 rounded-lg hover:bg-yellow-300 transition-transform hover:scale-105 shadow-md">‚úÖ Proceed to Checkout</button>
      </div>
    </div>
  </div>

  <!-- üü° Floating Cart Summary -->
  <div id="floating-summary" class="fixed bottom-6 right-6 bg-yellow-400 text-black px-4 py-2 rounded-full shadow-lg z-50 hidden text-sm font-semibold">
    üõí <span id="floating-count">0</span> items ¬∑ ‚Çπ<span id="floating-price">0</span>
  </div>

  <!-- üîª FOOTER -->
  <footer class="bg-black text-white text-center py-6 mt-16 border-t border-gray-800">
    <p class="text-sm">&copy; 2025 CarParts Marketplace. Engineered with ‚öôÔ∏è & passion.</p>
  </footer>

  <!-- ‚úÖ Firebase Auth with Avatar & Dropdown -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCt7256M7ocWrUk1BKXEhkwAbXxTQzoaEE",
      authDomain: "autocultive-b70df.firebaseapp.com",
      projectId: "autocultive-b70df",
      appId: "1:567543720829:web:682f549c40773ff3b5ba14"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    auth.onAuthStateChanged((user) => {
      const loginLink = document.querySelector('a[href="login.html"]');
      if (user && loginLink) {
        loginLink.style.display = "none";
        const avatarContainer = document.createElement("div");
        avatarContainer.id = "avatar-container";
        avatarContainer.className = "relative ml-2";

        const photoURL = user.photoURL || `https://api.dicebear.com/7.x/avataaars/svg?seed=autocultive&backgroundColor=transparent`;


        avatarContainer.innerHTML = `
          <img id="user-avatar" src="${photoURL}" class="w-10 h-10 rounded-full ring-2 ring-yellow-400 shadow-xl cursor-pointer hover:scale-110 transition-transform duration-300 animate-pulse" alt="User Avatar" />
          <div id="user-dropdown" class="absolute right-0 mt-3 w-64 rounded-2xl bg-black/90 backdrop-blur-md border border-yellow-500 shadow-2xl transition-all duration-300 ease-in-out opacity-0 invisible z-50">
            <div class="px-4 py-4 border-b border-yellow-600">
              <div id="user-email" class="text-yellow-300 font-semibold truncate">${user.email}</div>
            </div>
            <a href="orders.html" class="flex items-center gap-2 px-4 py-3 text-sm text-white hover:bg-yellow-700/30 transition">üõç <span>My Orders</span></a>
            <button onclick="logout()" class="flex items-center gap-2 w-full text-left px-4 py-3 text-sm text-red-400 hover:bg-red-700/40 transition">üö™ <span>Logout</span></button>
          </div>
        `;
        loginLink.parentNode.appendChild(avatarContainer);

        document.addEventListener("click", (e) => {
          const dropdown = document.getElementById("user-dropdown");
          const avatar = document.getElementById("user-avatar");

          if (avatar && avatar.contains(e.target)) {
            dropdown.classList.toggle("visible");
            dropdown.classList.toggle("opacity-100");
            dropdown.classList.toggle("invisible");
            dropdown.classList.toggle("opacity-0");
          } else if (dropdown && !dropdown.contains(e.target)) {
            dropdown.classList.remove("visible", "opacity-100");
            dropdown.classList.add("invisible", "opacity-0");
          }
        });
      }
    });

    function logout() {
      auth.signOut().then(() => {
        alert("üëã Logged out!");
        location.reload();
      });
    }
  </script>

  <!-- üõí Cart Logic -->
  <script>
    AOS.init();
    function renderCart() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const container = document.getElementById("cart-items");
      const footer = document.getElementById("cart-footer");
      const floating = document.getElementById("floating-summary");
      const subtotalDiv = document.getElementById("subtotal");
      const finalTotalDiv = document.getElementById("final-total");
      const floatingCount = document.getElementById("floating-count");
      const floatingPrice = document.getElementById("floating-price");

      container.innerHTML = "";

      if (cart.length === 0) {
        container.innerHTML = `
          <div class="text-center mt-20">
            <svg class="mx-auto mb-4 w-24 h-24 text-gray-500" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path d="M3 3h2l.4 2M7 13h14l-1.5 8H7L5 6H3"></path>
            </svg>
            <p class="text-gray-400 text-lg">Your cart is feeling lonely... üõçÔ∏è</p>
          </div>
        `;
        footer.classList.add("hidden");
        floating.classList.add("hidden");
        return;
      }

      footer.classList.remove("hidden");
      floating.classList.remove("hidden");

      let total = 0;

      cart.forEach((item, index) => {
        total += item.price;
        const card = document.createElement("div");
        card.className = "bg-gray-800 rounded-xl shadow-md p-6 grid grid-cols-1 sm:grid-cols-3 gap-4 items-center";
        card.innerHTML = `
          <img src="${item.image}" alt="${item.name}" class="w-24 h-24 object-cover rounded-lg">
          <div>
            <h2 class="text-xl font-semibold text-yellow-300">${item.name}</h2>
            <p class="text-sm text-gray-400">${item.category}</p>
            <p class="text-lg font-bold text-white mt-1">‚Çπ${item.price}</p>
            <div class="flex gap-2 mt-2">
              <button class="bg-gray-700 text-white px-2">‚àí</button>
              <span>1</span>
              <button class="bg-gray-700 text-white px-2">+</button>
            </div>
          </div>
          <div class="flex sm:justify-end items-start">
            <button onclick="removeItem(${index})" class="text-red-400 hover:underline text-sm font-medium">Remove</button>
          </div>
        `;
        container.appendChild(card);
      });

      subtotalDiv.textContent = `‚Çπ${total}`;
      finalTotalDiv.textContent = `‚Çπ${total}`;
      floatingCount.textContent = cart.length;
      floatingPrice.textContent = total;
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function clearCart() {
      localStorage.removeItem("cart");
      renderCart();
    }

    renderCart();
  </script>

</body>
</html>
